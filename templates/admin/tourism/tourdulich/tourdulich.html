<!-- DANH S√ÅCH TOUR DU L·ªäCH -->
<div class="mb-10">
  <!-- Ti√™u ƒë·ªÅ v√† n√∫t th√™m -->
  <div class="flex items-center justify-between mb-4">
    <h2 class="text-2xl font-bold text-green-700">üìã Danh s√°ch Tour du l·ªãch</h2>
    <button
      onclick="openTourModal()"
      class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 shadow"
    >
      ‚ûï Th√™m tour
    </button>
  </div>

  <!-- B·∫£ng danh s√°ch tour -->
  <div
    class="overflow-x-auto rounded-lg shadow border border-gray-200 h-[65vh] overflow-y-auto"
  >
    <table class="min-w-full text-sm text-gray-800">
      <thead class="bg-green-100 text-gray-700 text-left sticky top-0 z-10">
        <tr>
          <th class="px-4 py-3 border">#</th>
          <th class="px-4 py-3 border">T√™n tour</th>
          <th class="px-4 py-3 border">Gi√° tour</th>
          <th class="px-4 py-3 border">Th·ªùi gian di chuy·ªÉn</th>
          <th class="px-4 py-3 border">M√¥ t·∫£</th>
          <th class="px-4 py-3 border">H√¨nh ·∫£nh</th>
          <th class="px-4 py-3 border">L·ªãch tr√¨nh</th>
          <th class="px-4 py-3 border text-center">H√†nh ƒë·ªông</th>
        </tr>
      </thead>
      <tbody>
        {% for tour in tours %}
        <tr class="hover:bg-gray-50">
          <td class="px-4 py-3 border text-center">{{ tour.MA_TOUR }}</td>
          <td class="px-4 py-3 border">{{ tour.TEN_TOUR }}</td>
          <td class="px-4 py-3 border">{{ tour.GIA_TOUR|floatformat:0 }}‚Ç´</td>
          <td class="px-4 py-3 border">{{ tour.THOI_GIAN_DI_CHUYEN }}</td>
          <td class="px-4 py-3 border">
            {{ tour.MO_TA_TOUR|truncatewords:20 }}
          </td>
          <td class="px-4 py-3 border">
            {% if tour.HINH_TOUR %}
            <img
              src="{{ tour.HINH_TOUR }}"
              class="w-32 h-20 object-cover rounded"
            />
            {% else %}
            <span class="text-gray-400 italic">Kh√¥ng c√≥</span>
            {% endif %}
          </td>
          <td class="px-4 py-3 border">
            {% with thuoctours=tour.thuoctour_set.all %} {% if thuoctours %}
            <ul class="list-disc pl-4 text-xs text-gray-700">
              {% for item in thuoctours %}
              <li>
                {{ item.MA_DD.TEN_DIA_DIEM }} - {{ item.THOI_GIAN_DI|date:"d/m/Y
                H:i" }} ƒë·∫øn {{ item.THOI_GIAN_DEN|date:"d/m/Y H:i" }}
              </li>
              {% endfor %}
            </ul>
            {% else %}
            <span class="text-gray-400 italic">Ch∆∞a c√≥ l·ªãch tr√¨nh</span>
            {% endif %} {% endwith %}
          </td>

          <td class="px-4 py-3 border text-center">
            <div class="flex flex-col items-center space-y-2">
              <!-- N√∫t s·ª≠a -->
              <button
                class="bg-yellow-400 text-white px-3 py-1 rounded hover:bg-yellow-500 text-xs w-20"
                onclick="openTourModal({
                    ma_tour: '{{ tour.MA_TOUR }}',
                    ten_tour: '{{ tour.TEN_TOUR|escapejs }}',
                    gia_tour: '{{ tour.GIA_TOUR }}',
                    mo_ta: `{{ tour.MO_TA_TOUR|escapejs }}`,
                   
                    thoi_gian: '{{ tour.THOI_GIAN_DI_CHUYEN }}'
                  })"
              >
                ‚úèÔ∏è S·ª≠a
              </button>

              <!-- Form x√≥a -->
              <form
                action="{% url 'admin_tourism:xoa_tour' tour.MA_TOUR %}"
                method="POST"
                onsubmit="return confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a tour n√†y?')"
              >
                {% csrf_token %}
                <button
                  type="submit"
                  class="bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600 text-xs w-20"
                >
                  üóëÔ∏è X√≥a
                </button>
              </form>
            </div>
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="8" class="text-center py-3">Kh√¥ng c√≥ tour n√†o.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

<!-- Modal th√™m/s·ª≠a tour -->
{% include "admin/tourism/tourdulich/themsuatour.html" %}
